<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Drag &amp; Drop — Patina</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Inter:wght@300;400;500;600;700&family=Noto+Serif:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="design-system.css">
<link rel="stylesheet" href="components.css">
<style>
  /* Sortable — shared */
  .sortable-handle {
    cursor: grab;
    color: var(--text-muted);
    flex-shrink: 0;
    display: flex;
    align-items: center;
    user-select: none;
    padding: 2px;
  }
  .sortable-handle:active { cursor: grabbing; }
  .sortable-handle svg { display: block; }
  .sortable-ghost {
    opacity: 0.4;
    border: 2px dashed var(--accent) !important;
    background: var(--accent-bg) !important;
  }
  .sortable-chosen {
    box-shadow: var(--shadow-lg);
    transform: rotate(1deg);
  }
  .sortable-drag { opacity: 0.9; }
  .sortable-nested {
    margin-left: 28px;
    min-height: 8px;
  }

  /* Task list */
  .sortable-list {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }
  .sortable-item {
    display: flex;
    flex-direction: column;
    background: var(--white);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 12px 16px;
    transition: box-shadow 0.15s;
  }
  .sortable-item-row {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .sortable-item .sortable-content {
    flex: 1;
    min-width: 0;
  }
  .sortable-item .sortable-content .task-title {
    font-weight: 500;
    font-size: 0.9rem;
    color: var(--text);
  }
  .sortable-item .sortable-content .task-meta {
    font-size: 0.78rem;
    color: var(--text-muted);
    margin-top: 2px;
  }
  .sortable-item > .sortable-nested {
    margin-left: 24px;
    margin-top: 8px;
    min-height: 4px;
  }
  .sortable-item > .sortable-nested:empty {
    margin-top: 0;
  }
  .sortable-item--child {
    font-size: 0.85rem;
    background: var(--bg-warm);
  }
  .sortable-item--child .task-title { font-weight: 400; font-size: 0.85rem; }

  /* File tree */
  .sortable-tree {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }
  .sortable-folder { border-radius: var(--radius-sm); }
  .sortable-folder-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    border-radius: var(--radius-sm);
    cursor: default;
    font-weight: 500;
    font-size: 0.88rem;
    color: var(--text);
    background: var(--bg-warm);
    border: 1px solid var(--border);
  }
  .sortable-folder-header .folder-icon {
    flex-shrink: 0;
    color: var(--accent);
    display: flex;
  }
  .sortable-folder-header .folder-name { flex: 1; }
  .sortable-folder-header .folder-toggle {
    cursor: pointer;
    background: none;
    border: none;
    padding: 2px;
    color: var(--text-muted);
    display: flex;
    align-items: center;
    transition: transform 0.2s;
  }
  .sortable-folder-header .folder-toggle.collapsed { transform: rotate(-90deg); }
  .sortable-folder > .sortable-nested { margin-left: 0; padding-left: 20px; min-height: 24px; padding-top: 4px; padding-bottom: 4px; }
  .sortable-folder > .sortable-nested.collapsed { display: none; }
  .sortable-file {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 12px;
    border-radius: var(--radius-xs);
    font-size: 0.85rem;
    color: var(--text-secondary);
    border: 1px solid transparent;
    transition: background 0.12s;
  }
  .sortable-file:hover { background: var(--bg-warm); }
  .sortable-file .file-icon {
    flex-shrink: 0;
    color: var(--text-muted);
    display: flex;
  }

  /* Drag-over expand indicator */
  .sortable-folder.drag-hover > .sortable-folder-header {
    outline: 2px solid var(--accent);
    outline-offset: -2px;
  }
</style>
</head>
<body>
<div class="bg-grain"></div>
<div class="bg-shape bg-shape-1"></div>
<div class="bg-shape bg-shape-2"></div>
<div class="layout">
  <nav class="sidebar" id="sidebar"></nav>
  <main class="main" style="max-width:960px;">

    <div class="top-bar">
      <div class="top-bar-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg></div>
      <div class="top-bar-title">Drag &amp; Drop</div>
    </div>
    <div class="main-header">
      <h1 class="main-title">Drag &amp; Drop</h1>
      <p class="main-subtitle">Nested drag-and-drop lists powered by SortableJS. Reorder, nest, and restructure items with keyboard-accessible handles.</p>
    </div>

    <nav class="page-tabs">
      <a class="page-tab" href="#task-list">Task List</a>
      <a class="page-tab" href="#file-tree">File Tree</a>
    </nav>

    <!-- TASK LIST -->
    <section class="demo-section" id="task-list">
      <div class="demo-title">Task List</div>
      <div class="demo-desc">Nested todo items with subtasks. Drag items to reorder or nest under other tasks. Max nesting depth: 2.</div>
      <div class="demo-box">
        <div class="sortable-list" id="demo-task-list">

          <div class="sortable-item">
            <div class="sortable-item-row">
              <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
              <div class="sortable-content">
                <div class="task-title">Design system audit</div>
                <div class="task-meta">High priority &middot; Due Mar 3</div>
              </div>
            </div>
            <div class="sortable-nested">
              <div class="sortable-item sortable-item--child">
                <div class="sortable-item-row">
                  <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                  <div class="sortable-content">
                    <div class="task-title">Review color tokens</div>
                    <div class="task-meta">In progress</div>
                  </div>
                </div>
                <div class="sortable-nested"></div>
              </div>
              <div class="sortable-item sortable-item--child">
                <div class="sortable-item-row">
                  <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                  <div class="sortable-content">
                    <div class="task-title">Check typography scale</div>
                    <div class="task-meta">Pending</div>
                  </div>
                </div>
                <div class="sortable-nested"></div>
              </div>
            </div>
          </div>

          <div class="sortable-item">
            <div class="sortable-item-row">
              <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
              <div class="sortable-content">
                <div class="task-title">Refactor sidebar component</div>
                <div class="task-meta">Medium priority &middot; Due Mar 7</div>
              </div>
            </div>
            <div class="sortable-nested">
              <div class="sortable-item sortable-item--child">
                <div class="sortable-item-row">
                  <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                  <div class="sortable-content">
                    <div class="task-title">Extract navigation data</div>
                    <div class="task-meta">Pending</div>
                  </div>
                </div>
                <div class="sortable-nested"></div>
              </div>
            </div>
          </div>

          <div class="sortable-item">
            <div class="sortable-item-row">
              <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
              <div class="sortable-content">
                <div class="task-title">Write unit tests for charts</div>
                <div class="task-meta">Low priority &middot; Due Mar 14</div>
              </div>
            </div>
            <div class="sortable-nested"></div>
          </div>

          <div class="sortable-item">
            <div class="sortable-item-row">
              <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
              <div class="sortable-content">
                <div class="task-title">Update API documentation</div>
                <div class="task-meta">Medium priority &middot; Due Mar 10</div>
              </div>
            </div>
            <div class="sortable-nested"></div>
          </div>

          <div class="sortable-item">
            <div class="sortable-item-row">
              <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
              <div class="sortable-content">
                <div class="task-title">Performance optimization pass</div>
                <div class="task-meta">High priority &middot; Due Mar 5</div>
              </div>
            </div>
            <div class="sortable-nested">
              <div class="sortable-item sortable-item--child">
                <div class="sortable-item-row">
                  <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                  <div class="sortable-content">
                    <div class="task-title">Bundle size analysis</div>
                    <div class="task-meta">In progress</div>
                  </div>
                </div>
                <div class="sortable-nested"></div>
              </div>
              <div class="sortable-item sortable-item--child">
                <div class="sortable-item-row">
                  <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                  <div class="sortable-content">
                    <div class="task-title">Lazy-load below-fold sections</div>
                    <div class="task-meta">Pending</div>
                  </div>
                </div>
                <div class="sortable-nested"></div>
              </div>
            </div>
          </div>

        </div>
      </div>
      <details class="usage-toggle">
        <summary>When to use / avoid</summary>
        <div class="usage-block">
          <div class="usage-do">
            <div class="usage-label">When to use</div>
            <ul><li>Task lists with subtasks that need reordering</li><li>Priority or backlog grooming</li></ul>
          </div>
          <div class="usage-dont">
            <div class="usage-label">Avoid when</div>
            <ul><li>Items have fixed sort order (use static list)</li><li>Deeply nested hierarchies beyond 3 levels</li></ul>
          </div>
        </div>
      </details>
      <div class="code-panel">
        <button class="code-toggle" onclick="toggleCode(this)">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="9 18 15 12 9 6"/></svg>
          View code
        </button>
        <div class="code-block">
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
          <pre><code>&lt;div class="sortable-list" id="my-tasks"&gt;
  &lt;div class="sortable-item"&gt;
    &lt;div class="sortable-item-row"&gt;
      &lt;div class="sortable-handle"&gt;
        &lt;svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"&gt;
          &lt;circle cx="3" cy="3" r="1.5"/&gt;&lt;circle cx="9" cy="3" r="1.5"/&gt;
          &lt;circle cx="3" cy="9" r="1.5"/&gt;&lt;circle cx="9" cy="9" r="1.5"/&gt;
          &lt;circle cx="3" cy="15" r="1.5"/&gt;&lt;circle cx="9" cy="15" r="1.5"/&gt;
        &lt;/svg&gt;
      &lt;/div&gt;
      &lt;div class="sortable-content"&gt;
        &lt;div class="task-title"&gt;Task name&lt;/div&gt;
        &lt;div class="task-meta"&gt;Priority &amp;middot; Due date&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="sortable-nested"&gt;
      &lt;!-- child items go here --&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;script&gt;
patinaSortableNested('my-tasks', { maxDepth: 2 });
&lt;/script&gt;</code></pre>
        </div>
      </div>
    </section>

    <!-- FILE TREE -->
    <section class="demo-section" id="file-tree">
      <div class="demo-title">File Tree</div>
      <div class="demo-desc">Folders with files and subfolders. Drag to reorganize. Collapsed folders auto-expand when you hover during drag. Max depth: 3.</div>
      <div class="demo-box">
        <div class="sortable-tree" id="demo-file-tree">

          <!-- Folder: src -->
          <div class="sortable-folder">
            <div class="sortable-folder-header">
              <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
              <span class="folder-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg></span>
              <span class="folder-name">src</span>
              <button class="folder-toggle" aria-label="Toggle folder"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="6 9 12 15 18 9"/></svg></button>
            </div>
            <div class="sortable-nested">
              <div class="sortable-file">
                <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                <span class="file-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></span>
                index.js
              </div>
              <div class="sortable-file">
                <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                <span class="file-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></span>
                app.js
              </div>
              <!-- Subfolder: components -->
              <div class="sortable-folder">
                <div class="sortable-folder-header">
                  <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                  <span class="folder-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg></span>
                  <span class="folder-name">components</span>
                  <button class="folder-toggle" aria-label="Toggle folder"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="6 9 12 15 18 9"/></svg></button>
                </div>
                <div class="sortable-nested">
                  <div class="sortable-file">
                    <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                    <span class="file-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></span>
                    Button.jsx
                  </div>
                  <div class="sortable-file">
                    <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                    <span class="file-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></span>
                    Modal.jsx
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Folder: public -->
          <div class="sortable-folder">
            <div class="sortable-folder-header">
              <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
              <span class="folder-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg></span>
              <span class="folder-name">public</span>
              <button class="folder-toggle" aria-label="Toggle folder"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="6 9 12 15 18 9"/></svg></button>
            </div>
            <div class="sortable-nested">
              <div class="sortable-file">
                <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                <span class="file-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></span>
                index.html
              </div>
              <div class="sortable-file">
                <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                <span class="file-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></span>
                favicon.ico
              </div>
              <div class="sortable-file">
                <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                <span class="file-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></span>
                robots.txt
              </div>
            </div>
          </div>

          <!-- Folder: docs -->
          <div class="sortable-folder">
            <div class="sortable-folder-header">
              <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
              <span class="folder-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg></span>
              <span class="folder-name">docs</span>
              <button class="folder-toggle collapsed" aria-label="Toggle folder"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="6 9 12 15 18 9"/></svg></button>
            </div>
            <div class="sortable-nested collapsed">
              <div class="sortable-file">
                <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                <span class="file-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></span>
                README.md
              </div>
              <div class="sortable-file">
                <div class="sortable-handle" title="Drag to reorder"><svg width="12" height="18" viewBox="0 0 12 18" fill="currentColor"><circle cx="3" cy="3" r="1.5"/><circle cx="9" cy="3" r="1.5"/><circle cx="3" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="3" cy="15" r="1.5"/><circle cx="9" cy="15" r="1.5"/></svg></div>
                <span class="file-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></span>
                CHANGELOG.md
              </div>
            </div>
          </div>

        </div>
      </div>
      <details class="usage-toggle">
        <summary>When to use / avoid</summary>
        <div class="usage-block">
          <div class="usage-do">
            <div class="usage-label">When to use</div>
            <ul><li>File/folder reorganization interfaces</li><li>Tree structures with drag-and-drop reordering</li></ul>
          </div>
          <div class="usage-dont">
            <div class="usage-label">Avoid when</div>
            <ul><li>Read-only file trees (use static tree component)</li><li>Flat file lists without hierarchy</li></ul>
          </div>
        </div>
      </details>
      <div class="code-panel">
        <button class="code-toggle" onclick="toggleCode(this)">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="9 18 15 12 9 6"/></svg>
          View code
        </button>
        <div class="code-block">
          <button class="code-copy" onclick="copyCode(this)">Copy</button>
          <pre><code>&lt;div class="sortable-tree" id="my-tree"&gt;
  &lt;div class="sortable-folder"&gt;
    &lt;div class="sortable-folder-header"&gt;
      &lt;div class="sortable-handle"&gt;...&lt;/div&gt;
      &lt;span class="folder-icon"&gt;...&lt;/span&gt;
      &lt;span class="folder-name"&gt;Folder&lt;/span&gt;
      &lt;button class="folder-toggle"&gt;...&lt;/button&gt;
    &lt;/div&gt;
    &lt;div class="sortable-nested"&gt;
      &lt;div class="sortable-file"&gt;
        &lt;div class="sortable-handle"&gt;...&lt;/div&gt;
        &lt;span class="file-icon"&gt;...&lt;/span&gt;
        file.js
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;script&gt;
patinaSortableNested('my-tree', { maxDepth: 3 });
&lt;/script&gt;</code></pre>
        </div>
      </div>
    </section>

  </main>
</div>
<script>
(function(){
  const tabs = document.querySelectorAll('.page-tab');
  if (!tabs.length) return;
  const sections = Array.from(tabs).map(t => document.querySelector(t.getAttribute('href'))).filter(Boolean);
  function updateActive() {
    let current = sections[0];
    for (const s of sections) { if (s.getBoundingClientRect().top <= 120) current = s; }
    const id = current ? current.id : '';
    tabs.forEach(t => t.classList.toggle('active', t.getAttribute('href') === '#' + id));
  }
  document.querySelector('.main').addEventListener('scroll', updateActive);
  window.addEventListener('scroll', updateActive);
  updateActive();
})();
</script>
<script src="sidebar.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.6/Sortable.min.js"></script>
<script src="patina-sortable.js"></script>
<script>
  // Task list — nested sortable, max depth 2
  patinaSortableNested('demo-task-list', { maxDepth: 2 });

  // File tree — nested sortable, max depth 3
  patinaSortableNested('demo-file-tree', { maxDepth: 3 });

  // Folder collapse/expand toggles
  document.querySelectorAll('.folder-toggle').forEach(function(btn) {
    btn.addEventListener('click', function() {
      var nested = btn.closest('.sortable-folder').querySelector(':scope > .sortable-nested');
      if (!nested) return;
      btn.classList.toggle('collapsed');
      nested.classList.toggle('collapsed');
    });
  });

  // Auto-expand collapsed folders on 500ms drag hover
  (function() {
    var hoverTimer = null;

    var folders = document.querySelectorAll('.sortable-folder');
    folders.forEach(function(folder) {
      var header = folder.querySelector('.sortable-folder-header');
      if (!header) return;

      header.addEventListener('mouseenter', function() {
        if (!document.querySelector('.sortable-drag')) return;
        var nested = folder.querySelector(':scope > .sortable-nested');
        if (!nested || !nested.classList.contains('collapsed')) return;

        folder.classList.add('drag-hover');
        hoverTimer = setTimeout(function() {
          nested.classList.remove('collapsed');
          var toggle = header.querySelector('.folder-toggle');
          if (toggle) toggle.classList.remove('collapsed');
          folder.classList.remove('drag-hover');

          // Re-init sortable on the newly visible nested container
          if (window.Sortable) {
            Sortable.create(nested, {
              group: nested.closest('[id]') ? 'nested-filetree' : 'nested',
              handle: '.sortable-handle',
              animation: window.matchMedia('(prefers-reduced-motion: reduce)').matches ? 0 : 150,
              ghostClass: 'sortable-ghost',
              chosenClass: 'sortable-chosen',
              dragClass: 'sortable-drag',
              swapThreshold: 0.65,
              fallbackOnBody: true,
            });
          }
        }, 500);
      });

      header.addEventListener('mouseleave', function() {
        if (hoverTimer) { clearTimeout(hoverTimer); hoverTimer = null; }
        folder.classList.remove('drag-hover');
      });
    });
  })();

  // Code panel helpers
  function toggleCode(btn) {
    btn.classList.toggle('open');
    btn.nextElementSibling.classList.toggle('show');
  }
  function copyCode(btn) {
    var code = btn.nextElementSibling.textContent;
    navigator.clipboard.writeText(code).then(function() {
      btn.textContent = 'Copied!';
      btn.classList.add('copied');
      setTimeout(function() { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
    });
  }
</script>
</body>
</html>
